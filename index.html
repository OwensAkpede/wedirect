<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WeDirect</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&display=swap');
    * {
      font-family: 'Outfit', sans-serif;
    }
    body {
      background: radial-gradient(circle at 50% 20%, #ffffff, #e0f7fa, #fce4ec);
      background-attachment: fixed;
      animation: pulseBG 20s ease-in-out infinite;
      color: #3e3e3e;
    }
    @keyframes pulseBG {
      0%, 100% { filter: brightness(1); }
      50% { filter: brightness(1.03); }
    }
    .glow-ring {
      border: 2px solid rgba(255, 255, 255, 0.3);
      background: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(12px);
      transition: all 0.3s ease-in-out;
    }
    .shimmer {
      background: linear-gradient(90deg, #ffffff 25%, #f0f0f0 50%, #ffffff 75%);
      background-size: 400% 100%;
      animation: shimmer 2s infinite;
    }
    @keyframes shimmer {
      0% { background-position: -400% 0; }
      100% { background-position: 400% 0; }
    }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen px-4">
  <div class="glow-ring rounded-3xl p-8 max-w-2xl w-full text-center">
    <h1 class="text-5xl font-extrabold text-pink-600 tracking-wide">WeDirect</h1>
    <p class="text-base text-gray-600 mt-2">You’re being smoothly redirected…✨</p>

    <div id="redirectInfo" class="space-y-6 mt-10 hidden">
      <div class="rounded-xl w-full h-48 shimmer" id="bannerPlaceholder"></div>
      <img id="banner" src="" alt="Website Banner" class="rounded-xl w-full max-h-48 object-cover mx-auto hidden" />

      <div class="flex items-center justify-center gap-4">
        <img id="favicon" src="" alt="Favicon" class="w-12 h-12 rounded-full border" />
        <code id="urlText" class="text-sm text-pink-600 break-all"></code>
      </div>
      <div class="text-xs text-gray-500 italic">Guiding you there in <span id="count">3</span> seconds…</div>
    </div>

    <div id="fallbackPrompt" class="text-gray-600 mt-8">
      <p class="mb-2">Paste a destination URL in the path or hash to begin your journey:</p>
      <code class="block bg-pink-100 text-pink-600 p-2 rounded text-xs mb-1">https://wedirect.web.app/https://example.com</code>
      <code class="block bg-pink-100 text-pink-600 p-2 rounded text-xs">https://wedirect.web.app/#https://example.com</code>
    </div>
  </div>

  <script>
    async function getOGImage(url) {
      try {
        const res = await fetch(`https://api.microlink.io/?url=${encodeURIComponent(url)}&screenshot=false`);
        const data = await res.json();
        return data?.data?.image?.url || "/image.png";
      } catch {
        return "/image.png";
      }
    }

    window.onload = async () => {
      const rawPath = decodeURIComponent(window.location.pathname.slice(1));
      const rawHash = decodeURIComponent(window.location.hash.slice(1));
      const url = rawPath || rawHash;
      const isValidUrl = /^https?:\/\/[^ "']+$/.test(url);
      const redirectInfo = document.getElementById("redirectInfo");
      const fallbackPrompt = document.getElementById("fallbackPrompt");

      if (!url || !isValidUrl) return;

      fallbackPrompt.style.display = "none";
      redirectInfo.classList.remove("hidden");
      document.getElementById("urlText").textContent = url;
      document.getElementById("favicon").src = `https://www.google.com/s2/favicons?sz=64&domain_url=${url}`;

      const bannerUrl = await getOGImage(url);
      const banner = document.getElementById("banner");
      const placeholder = document.getElementById("bannerPlaceholder");

        banner.onload = () => {
          placeholder.style.display = 'none';
          banner.classList.remove("hidden");
        };
        banner.src = bannerUrl;

      let count = 3;
const countEl = document.getElementById("count");

const countdown = setInterval(() => {
  count--;
  countEl.textContent = count;
  if (count <= 0) {
    clearInterval(countdown);
            window.location.href = url;
  }
}, 1000);
    };
  </script>
</body>
</html>
